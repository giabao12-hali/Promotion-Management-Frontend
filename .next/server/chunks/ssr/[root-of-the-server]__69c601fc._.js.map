{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///D:/promotion-crm/promotion-frontend/lib/axiosConfig.ts"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst api = axios.create({\r\n    baseURL: process.env.NEXT_PUBLIC_API_URL,\r\n    headers: {\r\n        \"Content-Type\": \"application/json\"\r\n    },\r\n    withCredentials: false\r\n});\r\n\r\napi.interceptors.request.use(\r\n    (config) => {\r\n        if (typeof window !== 'undefined') {\r\n            const token = localStorage.getItem('token');\r\n            if (token) {\r\n                config.headers.Authorization = `Bearer ${token}`;\r\n            }\r\n        }\r\n        return config;\r\n    },\r\n    (error) => {\r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\napi.interceptors.response.use(\r\n    (response) => {\r\n        return response;\r\n    },\r\n    (error) => {\r\n        if (error.response?.status === 401) {\r\n            // Token expired hoặc invalid\r\n            if (typeof window !== 'undefined') {\r\n                localStorage.removeItem('token');\r\n                document.cookie = 'token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n                window.location.href = '/login';\r\n            }\r\n        }\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\nexport default api;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,MAAM,gJAAK,CAAC,MAAM,CAAC;IACrB,OAAO;IACP,SAAS;QACL,gBAAgB;IACpB;IACA,iBAAiB;AACrB;AAEA,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CACxB,CAAC;IACG;;IAMA,OAAO;AACX,GACA,CAAC;IACG,OAAO,QAAQ,MAAM,CAAC;AAC1B;AAGJ,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CACzB,CAAC;IACG,OAAO;AACX,GACA,CAAC;IACG,IAAI,MAAM,QAAQ,EAAE,WAAW,KAAK;QAChC,6BAA6B;QAC7B;;IAKJ;IACA,OAAO,QAAQ,MAAM,CAAC;AAC1B;uCAGW","debugId":null}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":["file:///D:/promotion-crm/promotion-frontend/services/auth/auth.service.ts"],"sourcesContent":["import api from \"@/lib/axiosConfig\";\r\n\r\nexport interface LoginPayload {\r\n    username: string;\r\n    password: string;\r\n}\r\n\r\nexport interface LoginResponse {\r\n    token: string;\r\n    fullName: string;\r\n    email: string;\r\n    phoneNumber: string;\r\n    role: number;\r\n}\r\n\r\nexport const AuthService = {\r\n    login: async (payload: LoginPayload): Promise<LoginResponse> => {\r\n        const res = await api.post(\"/api/Auth/login\", payload);\r\n        return res.data;\r\n    },\r\n\r\n    logout: () => {\r\n        if (typeof window !== 'undefined') {\r\n            localStorage.removeItem('token');\r\n            document.cookie = 'token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n        }\r\n    },\r\n\r\n    getToken: (): string | null => {\r\n        if (typeof window !== 'undefined') {\r\n            return localStorage.getItem('token');\r\n        }\r\n        return null;\r\n    },\r\n    \r\n    setToken: (token: string) => {\r\n        if (typeof window !== 'undefined') {\r\n            localStorage.setItem('token', token);\r\n            const expires = new Date();\r\n            expires.setTime(expires.getTime() + (7 * 24 * 60 * 60 * 1000)); // 7 days\r\n            // Trong development, không sử dụng secure flag\r\n            const isProduction = window.location.protocol === 'https:';\r\n            const secureFlag = isProduction ? '; secure' : '';\r\n            document.cookie = `token=${token}; expires=${expires.toUTCString()}; path=/; samesite=strict${secureFlag}`;\r\n        }\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;;AAeO,MAAM,cAAc;IACvB,OAAO,OAAO;QACV,MAAM,MAAM,MAAM,6HAAG,CAAC,IAAI,CAAC,mBAAmB;QAC9C,OAAO,IAAI,IAAI;IACnB;IAEA,QAAQ;QACJ;;IAIJ;IAEA,UAAU;QACN;;QAGA,OAAO;IACX;IAEA,UAAU,CAAC;QACP;;IASJ;AACJ","debugId":null}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///D:/promotion-crm/promotion-frontend/contexts/auth/AuthContext.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { AuthService } from \"@/services/auth/auth.service\";\r\nimport { createContext, ReactNode, useContext, useEffect, useState } from \"react\";\r\n\r\ninterface AuthContextType {\r\n    isAuthenticated: boolean;\r\n    token: string | null;\r\n    login: (token: string) => void;\r\n    logout: () => void;\r\n    isLoading: boolean;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider(\r\n    {\r\n        children\r\n    }: {\r\n        children: ReactNode\r\n    }\r\n) {\r\n    const [token, setToken] = useState<string | null>(null);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const storedToken = AuthService.getToken();\r\n        setToken(storedToken);\r\n        setIsLoading(false);\r\n    }, [])\r\n\r\n    const login = (newToken: string) => {\r\n        AuthService.setToken(newToken);\r\n        setToken(newToken);\r\n    };\r\n\r\n    const logout = () => {\r\n        AuthService.logout();\r\n        setToken(null);\r\n    }\r\n\r\n    return (\r\n        <AuthContext.Provider value={{\r\n            isAuthenticated: !!token,\r\n            token,\r\n            login,\r\n            logout,\r\n            isLoading\r\n        }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    )\r\n}\r\n\r\nexport function useAuth() {\r\n    const context = useContext(AuthContext);\r\n    if (context === undefined) {\r\n        throw new Error('useAuth must be used within an AuthProvider')\r\n    }\r\n\r\n    return context;\r\n}"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAaA,MAAM,4BAAc,IAAA,sNAAa,EAA8B;AAExD,SAAS,aACZ,EACI,QAAQ,EAGX;IAED,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAClD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,IAAA,kNAAS,EAAC;QACN,MAAM,cAAc,kJAAW,CAAC,QAAQ;QACxC,SAAS;QACT,aAAa;IACjB,GAAG,EAAE;IAEL,MAAM,QAAQ,CAAC;QACX,kJAAW,CAAC,QAAQ,CAAC;QACrB,SAAS;IACb;IAEA,MAAM,SAAS;QACX,kJAAW,CAAC,MAAM;QAClB,SAAS;IACb;IAEA,qBACI,8OAAC,YAAY,QAAQ;QAAC,OAAO;YACzB,iBAAiB,CAAC,CAAC;YACnB;YACA;YACA;YACA;QACJ;kBACK;;;;;;AAGb;AAEO,SAAS;IACZ,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACvB,MAAM,IAAI,MAAM;IACpB;IAEA,OAAO;AACX","debugId":null}}]
}